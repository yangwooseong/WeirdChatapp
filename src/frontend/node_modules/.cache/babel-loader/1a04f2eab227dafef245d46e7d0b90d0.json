{"ast":null,"code":"var _jsxFileName = \"/Users/yang-useong/ReactApp/chats/src/Store.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { io } from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CTX = /*#__PURE__*/React.createContext();\n/*\n    msg: {\n        from: 'user',\n        msg: 'hi',\n        topic: 'general'\n    }\n\n    state: {\n        topic1: [\n            {msg}, {msg}\n        ]\n        topic2: [\n            {msg}\n        ]\n    }\n*/\n\nconst initState = {\n  general: [{\n    from: 'aaron',\n    msg: 'hello'\n  }, {\n    from: 'archer',\n    msg: 'hi'\n  }],\n  topic2: [{\n    from: 'aaron',\n    msg: 'hola'\n  }]\n};\n\nfunction reducer(state, action) {\n  const {\n    from,\n    msg,\n    topic\n  } = action.payload;\n  console.log(state);\n  console.log(action.payload);\n\n  switch (action.type) {\n    case 'RECEIVE_MESSAGE':\n      console.log(1);\n      return { ...state,\n        [topic]: [...state[topic], {\n          from,\n          msg\n        }]\n      };\n\n    default:\n      return state;\n  }\n}\n\nexport default function Store(props) {\n  _s();\n\n  const [socket, setSocket] = useState(null);\n  useEffect(() => {\n    const socket = io('ws://127.0.0.1:5000');\n    socket.on('connect', () => console.log('connected'));\n    socket.on('chat message', msg => {\n      console.log('msg: ', msg);\n      dispatch({\n        payload: msg,\n        type: 'RECEIVE_MESSAGE'\n      });\n    });\n  }, []);\n  const [allChats, dispatch] = React.useReducer(reducer, initState);\n  console.log('after', allChats);\n  const user = 'aaron' + Math.random(100).toFixed(2);\n  return /*#__PURE__*/_jsxDEV(CTX.Provider, {\n    value: {\n      allChats,\n      socket,\n      user\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Store, \"OLD9wPLr3rcb4Wk7Xmq7hFiXk6Q=\");\n\n_c = Store;\n\nvar _c;\n\n$RefreshReg$(_c, \"Store\");","map":{"version":3,"sources":["/Users/yang-useong/ReactApp/chats/src/Store.js"],"names":["React","useEffect","useState","io","CTX","createContext","initState","general","from","msg","topic2","reducer","state","action","topic","payload","console","log","type","Store","props","socket","setSocket","on","dispatch","allChats","useReducer","user","Math","random","toFixed","children"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,EAAT,QAAmB,kBAAnB;;AAEA,OAAO,MAAMC,GAAG,gBAAGJ,KAAK,CAACK,aAAN,EAAZ;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMC,SAAS,GAAG;AACdC,EAAAA,OAAO,EAAE,CACL;AAACC,IAAAA,IAAI,EAAE,OAAP;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GADK,EAEL;AAACD,IAAAA,IAAI,EAAE,QAAP;AAAiBC,IAAAA,GAAG,EAAE;AAAtB,GAFK,CADK;AAKdC,EAAAA,MAAM,EAAE,CACJ;AAACF,IAAAA,IAAI,EAAE,OAAP;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GADI;AALM,CAAlB;;AAUA,SAASE,OAAT,CAAiBC,KAAjB,EAAwBC,MAAxB,EAAgC;AAC5B,QAAM;AAACL,IAAAA,IAAD;AAAOC,IAAAA,GAAP;AAAYK,IAAAA;AAAZ,MAAqBD,MAAM,CAACE,OAAlC;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYL,KAAZ;AACAI,EAAAA,OAAO,CAACC,GAAR,CAAYJ,MAAM,CAACE,OAAnB;;AACA,UAAOF,MAAM,CAACK,IAAd;AACI,SAAK,iBAAL;AACIF,MAAAA,OAAO,CAACC,GAAR,CAAY,CAAZ;AACA,aAAO,EACH,GAAGL,KADA;AAEH,SAACE,KAAD,GAAS,CACL,GAAGF,KAAK,CAACE,KAAD,CADH,EAEL;AACIN,UAAAA,IADJ;AAEIC,UAAAA;AAFJ,SAFK;AAFN,OAAP;;AAUJ;AACI,aAAOG,KAAP;AAdR;AAgBH;;AAID,eAAe,SAASO,KAAT,CAAeC,KAAf,EAAsB;AAAA;;AACjC,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBpB,QAAQ,CAAC,IAAD,CAApC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMoB,MAAM,GAAGlB,EAAE,CAAC,qBAAD,CAAjB;AACAkB,IAAAA,MAAM,CAACE,EAAP,CAAU,SAAV,EAAqB,MAAMP,OAAO,CAACC,GAAR,CAAY,WAAZ,CAA3B;AACAI,IAAAA,MAAM,CAACE,EAAP,CAAU,cAAV,EAA0Bd,GAAG,IAAI;AAC7BO,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBR,GAArB;AACAe,MAAAA,QAAQ,CAAC;AAACT,QAAAA,OAAO,EAAEN,GAAV;AAAeS,QAAAA,IAAI,EAAE;AAArB,OAAD,CAAR;AACH,KAHD;AAIH,GAPQ,EAON,EAPM,CAAT;AASA,QAAM,CAACO,QAAD,EAAWD,QAAX,IAAuBxB,KAAK,CAAC0B,UAAN,CAAiBf,OAAjB,EAA0BL,SAA1B,CAA7B;AAEAU,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAoBQ,QAApB;AAEA,QAAME,IAAI,GAAG,UAAUC,IAAI,CAACC,MAAL,CAAY,GAAZ,EAAiBC,OAAjB,CAAyB,CAAzB,CAAvB;AAEA,sBACI,QAAC,GAAD,CAAK,QAAL;AAAc,IAAA,KAAK,EAAE;AAACL,MAAAA,QAAD;AAAWJ,MAAAA,MAAX;AAAmBM,MAAAA;AAAnB,KAArB;AAAA,cACKP,KAAK,CAACW;AADX;AAAA;AAAA;AAAA;AAAA,UADJ;AAKH;;GAvBuBZ,K;;KAAAA,K","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { io } from 'socket.io-client'\n\nexport const CTX = React.createContext(); \n\n/*\n    msg: {\n        from: 'user',\n        msg: 'hi',\n        topic: 'general'\n    }\n\n    state: {\n        topic1: [\n            {msg}, {msg}\n        ]\n        topic2: [\n            {msg}\n        ]\n    }\n*/\n\nconst initState = {\n    general: [\n        {from: 'aaron', msg: 'hello'},\n        {from: 'archer', msg: 'hi'}\n    ],\n    topic2: [\n        {from: 'aaron', msg: 'hola'}\n    ]\n}\n\nfunction reducer(state, action) {\n    const {from, msg, topic} = action.payload\n    console.log(state)\n    console.log(action.payload)\n    switch(action.type) {\n        case 'RECEIVE_MESSAGE':\n            console.log(1)\n            return {\n                ...state,\n                [topic]: [\n                    ...state[topic],\n                    {\n                        from,\n                        msg\n                    }\n                ]\n            }\n        default:\n            return state\n    }\n}\n\n\n\nexport default function Store(props) {\n    const [socket, setSocket] = useState(null)\n\n    useEffect(() => {\n        const socket = io('ws://127.0.0.1:5000')\n        socket.on('connect', () => console.log('connected'))\n        socket.on('chat message', msg => {\n            console.log('msg: ', msg)\n            dispatch({payload: msg, type: 'RECEIVE_MESSAGE'})\n        })\n    }, [])\n    \n    const [allChats, dispatch] = React.useReducer(reducer, initState)\n\n    console.log('after',allChats)\n\n    const user = 'aaron' + Math.random(100).toFixed(2)\n\n    return (\n        <CTX.Provider value={{allChats, socket, user}} >\n            {props.children}\n        </CTX.Provider>\n    )\n} "]},"metadata":{},"sourceType":"module"}